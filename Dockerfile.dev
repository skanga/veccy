# Development Dockerfile for Veccy
# Includes development tools and hot reload support

FROM maven:3.9-eclipse-temurin-21

WORKDIR /app

# Install useful development tools
RUN apt-get update && \
    apt-get install -y curl vim less && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Copy pom.xml for dependency caching
COPY pom.xml .
RUN mvn dependency:go-offline -B

# Copy source
COPY src ./src

# Expose ports
EXPOSE 8080 8081 5005

# JVM debug options
ENV JAVA_OPTS="-Xmx2g -Xms512m -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005"

# Development mode - compile and run with hot reload
CMD ["mvn", "compile", "exec:java", "-Dexec.mainClass=com.veccy.VeccyApplication"]
